<style type="text/css">
	.form-actions {
		background: none;
	}
	
	.box .box-content.box-double-padding {
		padding: 20px 20px 0 20px;
	}
	
	.control-label {
		font-weight: bold;
	}
	
	.form-control {
		margin-bottom: 2px!important;
	}
</style>
<div class='container-fluid'>

	<div class='row-fluid' id='content-wrapper'>

		<div class='span12'>

			<div class='page-header'>

				<h1 class='pull-left'><i class='icon-briefcase'></i>&nbsp;&nbsp;<span>商户查询</span></h1>

				<div class="pull-right">

					<!--<div class="btn-group">

						<a href="__URL__/batchModifyClerk" class="btn btn-white">批量变更业务员</a>

					</div>-->

				</div>

			</div>

		</div>

		<div id="op_area" class="row-fluid" style="border: none;font-weight: bold;">

			<!--<div class="span2 box-quick-link green-background">

				<a href="__URL__/batchModifyClerk">

					<div class="header">

						<div class="icon-group"></div>

					</div>

					<div class="content">批量变更业务员</div>

				</a>

			</div>-->

			<div class="span2 box-quick-link muted-background boss">

				<a href="#" onclick="btnShowDetail()">

					<div class="header">

						<div class="icon-cog"></div>

					</div>

					<div class="content">变更基本信息</div>

				</a>

			</div>

			<div class="span2 box-quick-link muted-background boss">

				<a href="#" onclick="btnModifyReference()">

					<div class="header">

						<div class="icon-cog"></div>

					</div>

					<div class="content">变更推荐人</div>

				</a>

			</div>

			<div class="span2 box-quick-link muted-background boss">

				<a href="#" onclick="btnModifyState()">

					<div class="header">

						<div class="icon-cog"></div>

					</div>

					<div class="content">停用/启用</div>

				</a>

			</div>

		</div>

		<div class="row-fluid hidden" style="margin-top: 30px;">

			<div class="span12 box bordered-box blue-border box-collapsed">

				<div class="box-header blue-background">

					<div class="title">

						<i class="icon-search"></i>&nbsp;&nbsp;查询

					</div>

					<div class="actions">

						<a href="#" class="btn box-remove btn-mini btn-link hidden"><i class="icon-remove"></i></a>

						<a href="#" class="btn box-collapse btn-mini btn-link"><i></i></a>

					</div>

				</div>

				<div class="box-content box-double-padding">

					<form class="form" style="margin-bottom: 0;">
						<fieldset>
							<div class='span3'>
								<div class='control-group'>
									<label class='control-label'>商户编号或名称：</label>
									<div class='controls'>
										<input type="text" id="" value="" />
									</div>
								</div>
							</div>
							<div class='span3'>
								<div class='control-group'>
									<label class='control-label'>结算周期：</label>
									<div class='controls'>
										<select class='span5' name="">
											<option value="">-不限-</option>
											<option value="">工作日（T）</option>
											<option value="">自然日（D）</option>
										</select>
										<i class="icon-plus"></i>
										<input class='span5' id='full-name' type='number' />日
										<p class='help-block' />
									</div>
								</div>
							</div>

							<div class='span3'>
								<div class='control-group'>
									<label class='control-label'>商户注册状态：</label>
									<div class='controls'>
										<select name="">
											<option value="">-全部-</option>
											<option value="">待完成进件</option>
											<option value="">已完成进件</option>
											<option value="">绑定开通</option>
											<option value="">装机待审核 </option>
											<option value="">已装机</option>
											<option value="">已收押金</option>
											<option value="">财务审核通过</option>
										</select>
									</div>
								</div>
							</div>

							<div class='span3'>
								<div class='control-group'>
									<label class='control-label'>优惠协议：</label>
									<div class='controls'>
										<select name="">
											<option value="">-全部-</option>
											<option value="">无优惠协议</option>
											<option value="">县乡优惠</option>
											<option value="">三农优惠</option>
										</select>
									</div>
								</div>
							</div>

							<div class='span4' style="margin-left: 0;">
								<div class='control-group'>
									<label class='control-label'>行业大类：</label>
									<div class='controls'>
										<select name="" style="width: 90%;">
											<option value="">-全部-</option>
											<option value="">餐饮类</option>
											<option value="">一般类</option>
											<option value="">民生类</option>
											<option value="">房产汽车类</option>
											<option value="">批发类</option>
											<option value="">公益类</option>
										</select>
									</div>
								</div>
							</div>
							<div class='span2'>
								<div class='control-group'>
									<label class='control-label'>商户类别：</label>
									<div class='controls'>
										<select name="" style="width: 80%;">
											<option value="">-全部-</option>
											<option value="">A类</option>
											<option value="">T类</option>
										</select>
									</div>
								</div>
							</div>
							<div class='span2'>
								<div class='control-group'>
									<label class='control-label'>商户状态：</label>
									<div class='controls'>
										<select name="" style="width: 80%;">
											<option value="">-全部-</option>
											<option value="">正常</option>
											<option value="">停用</option>
										</select>
									</div>
								</div>
							</div>
							<div class='span2'>
								<div class='control-group'>
									<label class='control-label'>经营性质：</label>
									<div class='controls'>
										<select name="" style="width: 80%;">
											<option value="">-全部-</option>
											<option value="">企业</option>
											<option value="">个体</option>
										</select>
									</div>
								</div>
							</div>
							<div class='span2'>
								<div class='control-group'>
									<label class='control-label'>账户类别：</label>
									<div class='controls'>
										<select name="" style="width: 80%;">
											<option value="">-全部-</option>
											<option value="">对公</option>
											<option value="">对私</option>
										</select>
									</div>
								</div>
							</div>
							<div class='span4' style="margin-left: 0;">
								<div class='control-group'>
									<label class='control-label'>维护业务员：</label>
									<div class='controls'>
										<select name="" style="width: 90%;">

										</select>
									</div>
								</div>
							</div>

							<div class='span6' style="margin-left: 0;">
								<div class='control-group'>
									<label class='control-label'>创建日期：</label>
									<div class='controls'>
										<div class="datepicker input-append span5" id="datepicker" style="margin-top: -8px;">
											<input class="input-medium" data-format="yyyy-MM-dd" placeholder="起始时间" type="text">
											<span class="add-on"><i data-date-icon="icon-calendar" data-time-icon="icon-time" class="icon-calendar"></i></span>
										</div>
										<div class="datepicker input-append span5" id="datepicker" style="margin-top: -8px;">
											<input class="input-medium" data-format="yyyy-MM-dd" placeholder="截止时间" type="text">
											<span class="add-on"><i data-date-icon="icon-calendar" data-time-icon="icon-time" class="icon-calendar"></i></span>
										</div>
										<p class='help-block' />
									</div>
								</div>
							</div>

						</fieldset>

						<div class="form-actions" style="margin-bottom: 0;">

							<div class="text-right">

								<div class="btn btn-white">

									<i class="icon-search"></i>&nbsp;&nbsp;查询

								</div>

							</div>

						</div>

					</form>

				</div>

			</div>

		</div>

		<div class="row-fluid">
			<table id="table" class="datatable" data-striped="true" data-toggle="table" data-url="__CONTROLLER__/getList" data-show-columns="true" data-search="true" data-show-refresh="true" data-show-toggle="true" data-pagination="true" data-click-to-select="true"
				data-single-select="true" data-show-export="true">
				<thead>
					<tr>
						<th data-checkbox="true" data-field="ck"></th>
						<th data-align="center" data-field="basic_busi_no" data-formatter="noFormatter">商户号</th>
						<th data-field="basic_busi_address">经营地址</th>
						<th data-field="basic_busi_name">商户名称</th>
						<th data-field="basic_contract_channel">签约渠道</th>
						<th data-field="real_name">维护业务员</th>
						<th data-field="basic_industry_categories">行业大类</th>
						<th data-field="basic_busi_type">商户类别</th>
						<th data-field="basic_manag_nature">经营性质</th>
						<th data-field="settlement_period_type_all">结算周期</th>
						<th data-align="center" data-field="merchant_state" data-formatter="stateFormatter">商户状态</th>
						<th data-field="insertdate">创建时间</th>
						<th data-align="center" data-field="op" data-formatter="operateFormatter">操作</th>
					</tr>
				</thead>
			</table>
		</div>

	</div>

</div>

<script>
	var mbRole = "{$mbRole}";
	var mbID = "{$mbID}";
	$(function() {
		initHidden();
	});

	function initHidden() {
		if (mbRole == "外勤") {
			$("#op_area").hide();
			$("#table").bootstrapTable('hideColumn', 'op');
			$("#table").bootstrapTable('hideColumn', 'ck');
		} else if (mbRole == "内勤") {
			$("#op_area").hide();
			$(".boss").hide();
			$("#table").bootstrapTable('hideColumn', 'op');
			$("#table").bootstrapTable('hideColumn', 'ck');
		} else if (mbRole == "审批") {
			$(".boss").hide();
			$("#table").bootstrapTable('hideColumn', 'ck');
		} else {
		}
	};

	function btnShowDetail() {
		//		alert("Contacts:" + index);
		var rows = $("#table").bootstrapTable('getSelections');
		if (rows.length > 0) {
			console.log(rows[0]);
			window.location = "__URL__/showDetail?boss=boss&readonly=&serialNumber=" + rows[0]['serial_number'];
		}
	};

	function stateFormatter(value, row, index) {
		var txtColorClass = " text-success ";
		if (value == "停用") {
			txtColorClass = " text-error ";
		}
		return [
			'<p class="'+ txtColorClass +'">',
			value,
			'</p>'
		].join('');
	};

	function noFormatter(value, row, index) {
		return [
			'<a class="text-red" href="__URL__/showDetail?readonly=readonly&serialNumber=',
			row['serial_number'],
			'">',
			value,
			'</a>'
		].join('');
	};

	function operateFormatter(value, row, index) {
		return [
			' <div class="btn-group-vertical">',
			'<button style="min-width:120px" class="btn btn-primary" onclick="btnModifyContacts(' + index + ')">',
			'<i class="icon-pencil"></i>',
			'&nbsp;&nbsp;修改联系人',
			'</button>',
			'<button style="min-width:120px" class="btn btn-primary" onclick="btnModifyClerk(' + index + ')">',
			'<i class="icon-pencil"></i>',
			'&nbsp;&nbsp;修改业务员',
			'</button>',
			'</div>'
		].join('');
	};

	function btnModifyContacts(index) {
		//		alert("Contacts:" + index);
		var row = $("#table").bootstrapTable('getData')[index];
		console.log(row);
		window.location = "__URL__/modifyContacts?uuid=" + row['uuid'];
	};

	function btnModifyClerk(index) {
		var row = $("#table").bootstrapTable('getData')[index];
		console.log(row);
		window.location = "__URL__/modifyClerk?uuid=" + row['uuid'];
	};

	function btnModifyReference() {
		var rows = $("#table").bootstrapTable('getSelections');
		if (rows.length > 0) {
			console.log(rows[0]);
			window.location = "__URL__/modifyReference?uuid=" + rows[0]['uuid'];
		}
	}

	function btnModifyState() {
		var rows = $("#table").bootstrapTable('getSelections');
		if (rows.length > 0) {
			console.log(rows[0]);
			window.location = "__URL__/saveModifyState?uuid=" + rows[0]['uuid'];
		}
	}
</script>