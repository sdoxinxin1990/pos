<style type="text/css">
	.form-actions {
		background: none;
	}
	
	.box .box-content.box-double-padding {
		padding: 20px 20px 0 20px;
	}
	
	.control-label {
		font-weight: bold;
	}
	
	.form-control {
		margin-bottom: 2px!important;
	}
</style>
<div class='container-fluid'>

	<div class='row-fluid' id='content-wrapper'>

		<div class='span12'>

			<div class='page-header'>

				<h1 class='pull-left'><i class='icon-truck'></i>&nbsp;&nbsp;<span>商户信息录入</span></h1>

				<div class="pull-right">

					<!--<div class="btn-group">

						<a href="#" class="btn btn-white">录入企业商户</a>

						<a href="__CONTROLLER__/detail" class="btn btn-white">录入个体商户</a>

					</div>-->

				</div>

			</div>

		</div>

		<div class="row-fluid" style="border: none;font-weight: bold;">

			<div class="span2 box-quick-link green-background">

				<a href="__URL__/showAdd?type=企业">

					<div class="header">

						<div class="icon-group"></div>

					</div>

					<div class="content">录入企业商户</div>

				</a>

			</div>

			<div class="span2 box-quick-link orange-background">

				<a href="__URL__/showAdd?type=个体">

					<div class="header">

						<div class="icon-user"></div>

					</div>

					<div class="content">录入个体商户</div>

				</a>

			</div>

		</div>

		<div class="row-fluid hidden" style="margin-top: 30px;">

			<div class="span12 box bordered-box blue-border box-collapsed">

				<div class="box-header blue-background">

					<div class="title">

						<i class="icon-search"></i>&nbsp;&nbsp;查询

					</div>

					<div class="actions">

						<a href="#" class="btn box-remove btn-mini btn-link hidden"><i class="icon-remove"></i></a>

						<a href="#" class="btn box-collapse btn-mini btn-link"><i></i></a>

					</div>

				</div>

				<div class="box-content box-double-padding">

					<form class="form" style="margin-bottom: 0;">
						<fieldset>
							<div class='span3'>
								<div class='control-group'>
									<label class='control-label'>商户类别：</label>
									<div class='controls'>
										<select class='span12' name="">
											<option value="">-全部-</option>
											<option value="">A类商户</option>
											<option value="">T类商户</option>
										</select>
										<p class='help-block' />
									</div>
								</div>
							</div>
							<div class='span3'>
								<div class='control-group'>
									<label class='control-label'>审核状态：</label>
									<div class='controls'>
										<select class='span12' name="">
											<option value="">未提交</option>
										</select>
										<p class='help-block' />
									</div>
								</div>
							</div>
							<div class='span6'>
								<div class='control-group'>
									<label class='control-label'>结算周期：</label>
									<div class='controls'>
										<select class='span6' name="">
											<option value="">-不限-</option>
											<option value="">工作日（T）</option>
											<option value="">自然日（D）</option>
										</select>
										<i class="icon-plus"></i>
										<input class='span3' id='full-name' type='number' /> 个工作日
										<p class='help-block' />
									</div>
								</div>
							</div>

							<div class='span6' style="margin-left: 0;">
								<div class='control-group'>
									<label class='control-label'>提交日期：</label>
									<div class='controls'>
										<div class="datepicker input-append span5" id="datepicker" style="margin-top: -8px;">
											<input class="input-medium" data-format="yyyy-MM-dd" placeholder="起始时间" type="text">
											<span class="add-on"><i data-date-icon="icon-calendar" data-time-icon="icon-time" class="icon-calendar"></i></span>
										</div>
										<div class="datepicker input-append span5" id="datepicker" style="margin-top: -8px;">
											<input class="input-medium" data-format="yyyy-MM-dd" placeholder="截止时间" type="text">
											<span class="add-on"><i data-date-icon="icon-calendar" data-time-icon="icon-time" class="icon-calendar"></i></span>
										</div>
										<p class='help-block' />
									</div>
								</div>
							</div>
							<div class='span3'>
								<div class='control-group'>
									<label class='control-label'>账户类别：</label>
									<div class='controls'>
										<select class='span12' name="">
											<option value="">-不限-</option>
											<option value="">对公</option>
											<option value="">对私</option>
										</select>
										<p class='help-block' />
									</div>
								</div>
							</div>

							<div class='span12' style="margin-left: 0;">
								<div class='control-group'>
									<label class='control-label'>关键字：</label>
									<div class='controls'>
										<select class='span3' name="">
											<option value="">-不限-</option>
											<option value="">序号</option>
											<option value="">商户名称</option>
											<option value="">注册名称</option>
										</select>
										<input class='span6' id='full-name' type='text' />
										<p class='help-block' />
									</div>
								</div>
							</div>
						</fieldset>

						<div class="form-actions" style="margin-bottom: 0;">

							<div class="text-right">

								<div class="btn btn-white">

									<i class="icon-search"></i>&nbsp;&nbsp;查询

								</div>

							</div>

						</div>

					</form>

				</div>

			</div>

		</div>

		<div class="row-fluid">
			<table id="table" class="datatable" data-striped="true" data-toggle="table" data-url="__CONTROLLER__/getList?all=all" data-show-columns="true" data-search="true" data-show-refresh="true" data-show-toggle="true" data-pagination="true" data-show-export="true">
				<thead>
					<tr>
						<th data-align="center" data-field="serial_number" data-formatter="noFormatter">序号</th>
						<th data-field="basic_contract_channel">签约渠道</th>
						<th data-field="sign_contract_clerk">签约业务员</th>
						<th data-field="basic_busi_name">商户名称</th>
						<th data-field="basic_manag_nature">经营性质</th>
						<th data-field="create_datetime">更新时间</th>
						<th data-field="settlement_period_type_all">结算类型</th>
						<th data-field="settlement_account_type">账户类别</th>
						<th data-field="basic_busi_type">商户类别</th>
						<th data-field="state">审核状态</th>
						<th data-align="center" data-field="col10" data-formatter="operateFormatter">操作</th>
					</tr>
				</thead>
			</table>
		</div>

	</div>

</div>

<div class='modal hide fade' id='modal-example' role='dialog' tabindex='-1'>

	<div class='modal-header'>

		<button class='close' data-dismiss='modal' type='button'>&times;</button>

		<h3>询问</h3>

	</div>

	<div class='modal-body'>

		<p>确认删除该条商户录入信息？</p>

	</div>

	<div class='modal-footer'>

		<button class='btn' data-dismiss='modal'>取消</button>

		<button class='btn btn-danger' onclick="btnConfirmedRemove()">确认</button>

	</div>

</div>

<div class='modal hide fade' id='modal-example2' role='dialog' tabindex='-1'>

	<div class='modal-header'>

		<button class='close' data-dismiss='modal' type='button'>&times;</button>

		<h3>审批</h3>

	</div>

	<div class='modal-body'>

		<form action="__URL__/saveAddApprove" method="post" id="from_approve" class='form' style='margin-bottom: 0;' />

		<div class="hidden">
			<input id="res" name="res" type="reset" />
			<input type="text" name="uuid" value="" />
		</div>

		<div class='control-group'>

			<label class='control-label'>商户名称：</label>

			<div class='controls'>

				<input class='span12' id="input_busi_name" type='text' style="width: 300px;" readonly="readonly" />

				<p class='help-block' />

			</div>

		</div>

		<div class='control-group'>

			<label class='control-label'>商户号：</label>

			<div class='controls'>

				<input class='span12' name="basic_busi_no" type='text' style="width: 300px;" />

				<p class='help-block' />

			</div>

		</div>

		<div class='control-group'>

			<label class='control-label'>商户类别：</label>

			<div class='controls'>

				<select name="basic_busi_type">
					<option value="A类">A类</option>
					<option value="A类">T类</option>
				</select>

				<p class='help-block' />

			</div>

		</div>

		</form>

	</div>

	<div class='modal-footer'>

		<button class='btn' data-dismiss='modal'>&nbsp;&nbsp;取消&nbsp;&nbsp;</button>

		<button class='btn btn-success' onclick="btnConfirmedApprove()"><i class="icon-save"></i>&nbsp;&nbsp;保存&nbsp;&nbsp;</button>

	</div>

</div>

<script type="text/javascript">
	var rowIndexLastSeleted;
	var mbRole = "{$mbRole}";
	var mbID = "{$mbID}";

	function operateFormatter(value, row, index) {
		var hidden = "";
		var editHidden = "";
		var approveHidden = "";
		var removeHidden = "";
		if (mbRole == "外勤") {
			approveHidden = " hidden ";
			if (row['create_member_uuid'] != mbID) {
				editHidden = " hidden ";
				removeHidden = " hidden ";
			}
		}
		if (mbRole == "内勤") {
			approveHidden = " hidden ";
		}
		if (row.state != "待审核") {
			hidden = "hidden";
		}
		return [
			' <div class="btn-group-vertical">',
			'<a style="min-width:60px" class="' + editHidden + 'btn btn-primary ' + hidden + '" onclick="btnShowDetail(' + index + ')">',
			'<i class="icon-pencil"></i>',
			'&nbsp;&nbsp;编辑',
			'</a>',
			'<a style="min-width:60px" data-toggle="modal" href="#modal-example" class="' + removeHidden + 'btn btn-danger ' + hidden + '" onclick="btnAsk4remove(' + index + ')">',
			'<i class="icon-remove"></i>',
			'&nbsp;&nbsp;删除',
			'</a>',
			'<a style="min-width:60px" data-toggle="modal" href="#modal-example2" class="' + approveHidden + 'btn btn-success ' + hidden + '" onclick="btnAsk4approve(' + index + ')">',
			'<i class="icon-ok"></i>',
			'&nbsp;&nbsp;审批',
			'</a>',
			'</div>'
		].join('');
	};

	function noFormatter(value, row, index) {
		return [
			'<a class="text-red" href="__URL__/showDetail?readonly=readonly&serialNumber=',
			value,
			'">',
			value,
			'</a>'
		].join('');
	};

	function btnShowDetail(index) {
		//		alert("Contacts:" + index);
		var row = $("#table").bootstrapTable('getData')[index];
		console.log(row);
		window.location = "__URL__/showDetail?readonly=&serialNumber=" + row['serial_number'];
	};

	function btnAsk4remove(index) {
		//		alert(index);
		rowIndexLastSeleted = index;
	};

	function btnAsk4approve(index) {
		//		alert(index);
		var row = $("#table").bootstrapTable('getData')[index];
		$("#input_busi_name").val(row['basic_busi_name']);
		$("[name='uuid']").val(row['uuid']);
		rowIndexLastSeleted = index;
	};

	function btnConfirmedRemove() {
		var row = $("#table").bootstrapTable('getData')[rowIndexLastSeleted];
		console.log(row);
		window.location = "__URL__/delete?serialNumber=" + row['serial_number'];
		//		alert(rowIndexLastSeleted);
	};

	function btnConfirmedApprove() {
		//		var data = $("#from_approve").serialize();
		//		bootbox.alert(data);
		$("#from_approve").submit();
	}
</script>